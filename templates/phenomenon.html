<!-- 現象データ表示 -->
<div class="data-container">
    <h2>追加された現象データ</h2>
    <ul id="phenomena-list">
        {% for idx, (category, subcategory, change_area) in enumerate(phenomena) %}
        <li id="phenomenon-{{ idx }}">
            {{ category }} - {{ subcategory }} - {{ change_area }}
            <button type="button" onclick="removePhenomenon({{ idx }})" style="margin-left: 10px;">削除</button>
        </li>
        {% endfor %}
    </ul>
    
    <!-- 完了して保存ボタン -->
    <div class="save-button-container">
        <form action="/save_phenomena" method="post">
            <input type="hidden" name="file_name" value="{{ file_name }}">
            <button type="submit">完了して保存</button>
        </form>
    </div>
</div>

<script>
    // 現象を削除する関数
    function removePhenomenon(index) {
        const phenomenonItem = document.getElementById(`phenomenon-${index}`);
        const phenomenaList = document.getElementById("phenomena-list");

        // リスト内の該当エントリを削除
        if (phenomenonItem && phenomenaList) {
            phenomenaList.removeChild(phenomenonItem);

            // サーバーサイドで削除を保存するためのリクエスト送信
            fetch(`/remove_phenomenon/${index}`, {
                method: "POST",
            }).then((response) => {
                if (!response.ok) {
                    console.error("削除に失敗しました");
                } else {
                    console.log("削除成功");
                }
            });
        }
    }
</script>